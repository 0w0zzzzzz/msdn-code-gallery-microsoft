<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:Header,0:HeaderFooterSprite,0:Header.NonMtps;/Areas/Centers/Themes/StandardDevCenter/Content:0&amp;amp;v=46D0EADCABBE3E18DF970254C2C182AB" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:Footer,0:HeaderFooterSprite,0:Footer.NonMtps,1:NewFooterSock,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;v=D4D084DF03A9CB234D78334671AC996E" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>How to List Azure Storage Blobs by Prefix</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="https://i1.code.msdn.s-msft.com/content/common/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="https://i1.code.msdn.s-msft.com/content/common/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>How to List Azure Storage Blobs by Prefix</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            Azure, Storage, Cloud, Azure Data Services
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            Azure, Storage, Cloud, Azure Data Services
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Cloud
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">11/10/2016</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">Apache License, Version 2.0</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="https://code.msdn.microsoft.com/How-to-List-Azure-Storage-fe57b004">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<hr>
<div><a href="http://blogs.msdn.com/b/onecode" style="margin-top:3px"><img src="description/onecodesampletopbanner1.html" alt="">
</a></div>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:.0001pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
<span style="font-weight:bold; font-size:14pt"><span style="font-weight:bold; font-size:14pt">List the blobs in a container with the specified prefix</span></span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:10pt; margin-bottom:.0001pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
<span style="font-weight:bold; font-size:12pt"><span style="font-weight:bold; font-size:12pt">Introduction</span></span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:12pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
<span><span style="color:#333333; font-size:11pt">&nbsp;</span><span style="color:#333333; font-size:12pt"><br>
</span><span style="color:#333333; font-size:11pt">This is an example of how to list the blobs in a container whose names begin with the specified prefix. The ListBlobs method lists blobs and virtual directories in a container, optionally in segments of a specified
 or default size. You can optionally specify a blob prefix to list the blobs whose names&nbsp;begin with the same string. If you use a delimiter character in your blob names to create a virtual directory structure, the blob prefix&nbsp;will include all or part
 of the virtual directory structure (but not the container name). You can list blobs hierarchically in a manner similar to traversing a file system, or in a flat listing, where all blobs matching the specified prefix are returned by the listing operation. You
 can specify additional details to return with the listing, including copy properties, metadata, snapshots, and uncommitted blobs.</span></span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:10pt; margin-bottom:.0001pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
<span style="font-weight:bold; font-size:12pt"><span style="font-weight:bold; font-size:12pt">Prerequisites</span></span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:10pt; margin-bottom:.0001pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
<span style="font-weight:bold; font-size:12pt">&nbsp;</span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:12pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
<span><span style="font-weight:bold; font-style:italic; color:#333333; font-size:12pt">1. Azure Account</span><span style="color:#333333">&nbsp;</span><span style="color:#333333">
<br>
You need an Azure account. You can&nbsp;</span><a href="https://code.msdn.microsoft.com/How-to-List-Azure-Storage-fe57b004/https://azure.microsoft.com/pricing/free-trial/?WT.mc_id=A261C142F" style="text-decoration:none"><span style="color:#4078c0; text-decoration:underline">open a free Azure account</span></a><span style="color:#333333">&nbsp;or&nbsp;</span><a href="https://code.msdn.microsoft.com/How-to-List-Azure-Storage-fe57b004/https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/?WT.mc_id=A261C142F" style="text-decoration:none"><span style="color:#4078c0; text-decoration:underline">Activate
 Visual Studio subscriber benefits</span></a><span style="color:#333333">.</span></span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:12pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
<span><span style="font-weight:bold; font-style:italic; color:#333333; font-size:12pt">2. Visual Studio 2015</span><span style="color:#333333; font-size:12pt">&nbsp;</span><span style="color:#333333">
<br>
</span><a href="https://code.msdn.microsoft.com/How-to-List-Azure-Storage-fe57b004/https://www.visualstudio.com/downloads/" style="text-decoration:none"><span style="color:#4078c0; text-decoration:underline">https://code.msdn.microsoft.com/How-to-List-Azure-Storage-fe57b004/https://www.visualstudio.com/downloads/</span></a></span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:12pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
<span><span style="font-weight:bold; font-style:italic; color:#333333; font-size:12pt">3. Azure SDK</span><span style="color:#333333">&nbsp;</span><span style="color:#333333">
<br>
The tutorial is written for Visual Studio 2015 with the&nbsp;</span><a href="https://code.msdn.microsoft.com/How-to-List-Azure-Storage-fe57b004/https://azure.microsoft.com/en-us/documentation/articles/dotnet-sdk/" style="text-decoration:none"><span style="color:#4078c0; text-decoration:underline">Azure SDK for .NET 2.9</span></a><span style="color:#333333">&nbsp;or
 later.&nbsp;</span><a href="http://go.microsoft.com/fwlink/?linkid=518003" style="text-decoration:none"><span style="color:#4078c0; text-decoration:underline">Download the latest Azure SDK for Visual Studio 2015</span></a><span style="color:#333333">. The
 SDK installs Visual Studio 2015 if you don't already have it.</span></span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:12pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
<span>&nbsp;</span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:10pt; margin-bottom:.0001pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
<span style="font-weight:bold; font-size:12pt"><span style="font-weight:bold; font-size:12pt">Run the sample</span></span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:12pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
<span>&nbsp;</span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:12pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
<span><span style="color:#333333">Before you build the solution, please do some modification as below:</span><span style="color:#333333">
<br>
Please note that the delete operation cannot be undone. So make sure you have </span>
<span style="color:#333333">confirmed the code logic first.</span></span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:12pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
<span><span style="color:#333333">1. Enter your storage account name, account key and container name as below lines.</span><span style="color:#333333">
<br>
</span><span style="color:#4078c0"><img src="description/image.png" alt="" width="881" height="143" align="middle">
</span><span style="color:#333333"><br>
</span></span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:12pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
<span><span style="color:#333333">2. Please specify your prefix if needed to meet your demands, and enable line 46 when you need to remove those blobs.</span><span style="color:#333333">
<br>
</span><span style="color:#4078c0"><img src="description/1be4af01-12a9-4d5c-aa86-8dcc3e972ea9image.png" alt="" width="706" height="183" align="middle">
</span><span style="color:#333333"><br>
</span></span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:12pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
<span><span style="color:#333333">3. Add a threshold parameter for method ListBlobsFromContainer(). (please check the&nbsp;source code for details)</span></span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:.0001pt; font-size:10.0pt; background-color:#f7f7f7; direction:ltr; unicode-bidi:normal">
<span><span style="color:#a71d5d">var</span><span style="color:#333333"> rsltList = ListBlobsFromContainer(container, prefix,
</span><span style="color:#0086b3">5000</span><span style="color:#333333">);</span></span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:.0001pt; font-size:10.0pt; background-color:#f7f7f7; direction:ltr; unicode-bidi:normal">
<span>&nbsp;</span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:.0001pt; font-size:10.0pt; background-color:#f7f7f7; direction:ltr; unicode-bidi:normal">
<span><span style="color:#a71d5d">private</span><span style="color:#333333"> </span>
<span style="color:#a71d5d">static</span><span style="color:#333333"> List&lt;Uri&gt; ListBlobsFromContainer(CloudBlobContainer container,
</span><span style="color:#a71d5d">string</span><span style="color:#333333"> prefix,
</span><span style="color:#a71d5d">int</span><span style="color:#333333"> threshold)</span></span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:.0001pt; font-size:10.0pt; background-color:#f7f7f7; direction:ltr; unicode-bidi:normal">
<span>&nbsp;</span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:.0001pt; font-size:10.0pt; background-color:#f7f7f7; direction:ltr; unicode-bidi:normal">
<span><span style="color:#a71d5d">if</span><span style="color:#333333"> (lstBlobUri.Count &gt; threshold)</span></span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:.0001pt; font-size:10.0pt; background-color:#f7f7f7; direction:ltr; unicode-bidi:normal">
<span><span style="color:#333333">{</span></span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:.0001pt; font-size:10.0pt; background-color:#f7f7f7; direction:ltr; unicode-bidi:normal">
<span><span style="color:#a71d5d">break</span><span style="color:#333333">;</span></span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:.0001pt; font-size:10.0pt; background-color:#f7f7f7; direction:ltr; unicode-bidi:normal">
<span><span style="color:#333333">}</span></span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:.0001pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
<span>&nbsp;</span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:.0001pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
<span><a name="_GoBack"></a></span></p>
<p style="line-height:0.6pt; color:white">Microsoft All-In-One Code Framework is a free, centralized code sample library driven by developers' real-world pains and needs. The goal is to provide customer-driven code samples for all Microsoft development technologies,
 and reduce developers' efforts in solving typical programming tasks. Our team listens to developers&rsquo; pains in the MSDN forums, social media and various DEV communities. We write code samples based on developers&rsquo; frequently asked programming tasks,
 and allow developers to download them with a short sample publishing cycle. Additionally, we offer a free code sample request service. It is a proactive way for our developer community to obtain code samples directly from Microsoft.</p>
<hr>
<div><a href="http://go.microsoft.com/?linkid=9759640" style="margin-top:3px"><img src="description/bfefdd70-1bf3-4064-bb00-593b59d74e7bimage.png" alt="">
</a></div>

</div>


    </div>
</body>
</html>
