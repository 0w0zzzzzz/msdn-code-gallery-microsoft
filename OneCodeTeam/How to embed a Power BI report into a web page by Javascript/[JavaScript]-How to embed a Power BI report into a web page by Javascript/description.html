<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:Header,0:HeaderFooterSprite,0:Header.NonMtps;/Areas/Centers/Themes/StandardDevCenter/Content:0&amp;amp;v=875F4807220CE6912BAB87167976178B" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:Footer,0:HeaderFooterSprite,0:Footer.NonMtps,1:NewFooterSock,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;v=10B55093DA08CEEF26023F25F71F9E5B" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>How to embed a Power BI report into a web page by Javascript</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="https://i1.code.msdn.s-msft.com/content/common/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="https://i1.code.msdn.s-msft.com/content/common/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>How to embed a Power BI report into a web page by Javascript</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            Javascript, HTML, power bi, Languages, Power BI Embedded
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            jQuery, Javascript, HTML, power bi, Power BI Embedded
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Web
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">3/30/2017</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">Apache License, Version 2.0</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="https://code.msdn.microsoft.com/How-to-embed-a-Power-BI-1bb9c04a">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<hr>
<div><a href="http://blogs.msdn.com/b/onecode" style="margin-top:3px"><img src="description/onecodesampletopbanner1.html" alt="">
</a></div>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:.0001pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
<span style="font-weight:bold; font-size:14pt"><span style="background-color:#fcfcfc; color:#000000; font-size:13.5pt">&nbsp;</span><a name="OLE_LINK1"></a><span style="background-color:#fcfcfc; color:#000000; font-size:13.5pt">How
</span><span style="background-color:#fcfcfc; color:#000000; font-size:13.5pt">to
</span><span style="background-color:#fcfcfc; color:#000000; font-size:13.5pt">embed a Power BI</span><span style="background-color:#fcfcfc; color:#000000; font-size:13.5pt"> report into a web page by Javas</span><span style="background-color:#fcfcfc; color:#000000; font-size:13.5pt">cript</span></span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:.0001pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
<span style="font-weight:bold; font-size:14pt"><span style="font-weight:bold; font-size:14pt">Introduction
</span></span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:.0001pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
<span><span>This sample demonstrates how </span><span>to </span><span>embed a Power BI report into a web page by Java</span><span>s</span><span>cript</span><span>.</span></span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:.0001pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
<span><span>Power BI Embedded is one of the Azure services. Only the ISV who uses Azure Portal is charged for usage fees (per hourly user session), and the user who views the report isn't charged or even require an Azure subscription.</span></span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:10pt; margin-bottom:.0001pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
<span style="font-weight:bold; font-size:12pt"><span style="font-weight:bold; font-size:12pt">Sample prerequisites</span></span></p>
<p style="font-size:10.0pt; direction:ltr; unicode-bidi:normal; margin:0pt"><span style="font-size:12pt"><span style="font-size:10pt">Before you run this sample, you should know your
</span><span style="font-weight:bold; font-size:10pt">Workspace Collection</span><span style="font-size:10pt"> name and Access Key. And in your
</span><span style="font-weight:bold; font-size:10pt">Workspace Collection</span><span style="font-size:10pt">, ther</span><span style="font-size:10pt">e</span><span style="font-size:10pt"> should be at least one workspace, and one report dataset.</span></span></p>
<p style="font-size:10.0pt; direction:ltr; unicode-bidi:normal; margin:0pt"><span style="font-size:12pt"><span style="font-size:10pt">If you don&rsquo;t have a Power BI Embedded service, you can follow this link
</span><a href="https://code.msdn.microsoft.com/How-to-embed-a-Power-BI-1bb9c04a/https://code.msdn.microsoft.com/How-to-embed-a-Power-BI-1bb9c04a/https://docs.microsoft.com/en-us/azure/power-bi-embedded/power-bi-embedded-get-started-sample" style="text-decoration:none"><span style="color:#0563c1; font-size:10pt; text-decoration:underline">https://docs.microsoft.com/en-us/azure/power-b</span><span style="color:#0563c1; font-size:10pt; text-decoration:underline">i</span><span style="color:#0563c1; font-size:10pt; text-decoration:underline">-embedded/power-bi-embedded-get-started-sample</span></a><span style="font-size:10pt">
</span><span style="font-size:10pt">to create workspaces and import re</span><span style="font-size:10pt">port to it.</span></span></p>
<p style="font-size:10.0pt; direction:ltr; unicode-bidi:normal; margin:0pt"><strong><span style="font-size:12pt"><span style="font-size:10pt">Important:
</span></span></strong><span style="font-size:12pt"><span style="font-size:10pt">If you're using Azure China service, please follow this
</span></span><span style="font-size:12pt"><span style="font-size:10pt"><a href="https://code.msdn.microsoft.com/How-to-embed-a-Power-BI-1bb9c04a/https://www.azure.cn/documentation/articles/power-bi-embedded-get-started-sample/">document&nbsp;for China</a>.&nbsp;</span></span><span style="font-size:10pt">And before running
 the sample, please replace </span><span style="font-size:10pt">the request url&nbsp;</span><span style="font-size:10pt">&quot;</span><span style="font-size:10pt">https://api.powerbi.com</span><span style="font-size:10pt">&quot; to &quot;</span><span style="font-size:10pt">https://api.powerbi.cn</span><span style="font-size:10pt">&quot;
 in the html.</span></p>
<p style="font-size:10.0pt; direction:ltr; unicode-bidi:normal; margin:0pt"><span style="font-size:12pt"><span style="font-size:10pt"><br>
</span></span></p>
<p style="font-size:10.0pt; direction:ltr; unicode-bidi:normal; margin:0pt"><span style="font-size:12pt"><span style="font-size:10pt"><img src="description/image.png" alt="" width="643" height="301" align="middle">
</span></span></p>
<p style="font-size:10.0pt; direction:ltr; unicode-bidi:normal; margin:0pt"><span style="font-size:12pt">&nbsp;</span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:10pt; margin-bottom:.0001pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
<span style="font-weight:bold; font-size:12pt"><span style="font-weight:bold; font-size:12pt">Running the sample</span></span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:.0001pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
<span><span>T</span><span>his</span><span> is a static html page. Download the source and find the index.html. Open it in your Web B</span><span>rowser</span><span>.</span></span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:.0001pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
<span><span><img src="description/91d0c747-1101-495f-be4e-7fa2fd065903image.png" alt="" width="603" height="563" align="middle">
</span></span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:.0001pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
<span>&nbsp;</span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:.0001pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
<span><span>Input </span><span style="font-weight:bold">Workspace Collection Name</span><span> and
</span><span style="font-weight:bold">Access Key</span><span>, then click </span>
<span style="font-weight:bold">Get Workspaces</span><span>.</span></span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:.0001pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
<span><span><img src="description/0723462a-5eff-48d8-9b5d-7796adbedbcaimage.png" alt="" width="603" height="563" align="middle">
</span></span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:.0001pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
<span>&nbsp;</span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:.0001pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
<span><span>A</span><span>fter</span><span> the workspaces and reports are loaded, click Embed button. Then you can see the report.</span></span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:.0001pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
<span><span><img src="description/b732e703-3d21-42bb-a2b6-9b79c9cf27f6image.png" alt="" width="830" height="867" align="middle">
</span></span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:.0001pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
<span>&nbsp;</span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:.0001pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
<span><span style="font-weight:bold; font-size:12pt">Using the code</span></span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:.0001pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
Get access token:</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>JavaScript</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">js</span>
<pre class="hidden">function getAccessToken(accessKey, workspaceId, reportId, workspaceCollectionName) {
    var token1 = '{&quot;alg&quot;: &quot;HS256&quot;,&quot;typ&quot;: &quot;JWT&quot;}';
    var nbf = new Date().getTime() / 1000 | 0;
    var exp = new Date().setTime(new Date().getTime() &#43; 60 * 60 * 1000) / 1000 | 0;
    var token2 = '{&quot;ver&quot;:&quot;0.2.0&quot;,&quot;wcn&quot;:&quot;' &#43; workspaceCollectionName &#43; '&quot;,&quot;wid&quot;: &quot;' &#43; workspaceId &#43; '&quot;,&quot;rid&quot;:&quot;' &#43; reportId &#43; '&quot;,&quot;iss&quot;:&quot;PowerBISDK&quot;,&quot;aud&quot;:&quot;https://analysis.windows.net/powerbi/api&quot;,&quot;exp&quot;:' &#43; exp &#43; ',&quot;nbf&quot;:' &#43; nbf &#43; '}'
    var endcodedToken = encode_helper(token1) &#43; '.' &#43; encode_helper(token2);
    var hash = CryptoJS.HmacSHA256(endcodedToken, accessKey);
    var hashInBase64 = CryptoJS.enc.Base64.stringify(hash);
    var sig = formatString(hashInBase64);
    var accessToken = endcodedToken &#43; '.' &#43; sig;
    return accessToken;
}

function encode_helper(arg) {
    var response = btoa(arg);
    return formatString(response);
}

//replace special char in the string
function formatString(arg) {
    var response = arg;
    response = response.replace(/\//g, &quot;_&quot;);
    response = response.replace(/\&#43;/g, &quot;-&quot;);
    response = response.replace(/=&#43;$/, '');;
    return response;
}</pre>
<div class="preview">
<pre class="js"><span class="js__operator">function</span>&nbsp;getAccessToken(accessKey,&nbsp;workspaceId,&nbsp;reportId,&nbsp;workspaceCollectionName)&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">var</span>&nbsp;token1&nbsp;=&nbsp;<span class="js__string">'{&quot;alg&quot;:&nbsp;&quot;HS256&quot;,&quot;typ&quot;:&nbsp;&quot;JWT&quot;}'</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">var</span>&nbsp;nbf&nbsp;=&nbsp;<span class="js__operator">new</span>&nbsp;<span class="js__object">Date</span>().getTime()&nbsp;/&nbsp;<span class="js__num">1000</span>&nbsp;|&nbsp;<span class="js__num">0</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">var</span>&nbsp;exp&nbsp;=&nbsp;<span class="js__operator">new</span>&nbsp;<span class="js__object">Date</span>().setTime(<span class="js__operator">new</span>&nbsp;<span class="js__object">Date</span>().getTime()&nbsp;&#43;&nbsp;<span class="js__num">60</span>&nbsp;*&nbsp;<span class="js__num">60</span>&nbsp;*&nbsp;<span class="js__num">1000</span>)&nbsp;/&nbsp;<span class="js__num">1000</span>&nbsp;|&nbsp;<span class="js__num">0</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">var</span>&nbsp;token2&nbsp;=&nbsp;<span class="js__string">'{&quot;ver&quot;:&quot;0.2.0&quot;,&quot;wcn&quot;:&quot;'</span>&nbsp;&#43;&nbsp;workspaceCollectionName&nbsp;&#43;&nbsp;<span class="js__string">'&quot;,&quot;wid&quot;:&nbsp;&quot;'</span>&nbsp;&#43;&nbsp;workspaceId&nbsp;&#43;&nbsp;<span class="js__string">'&quot;,&quot;rid&quot;:&quot;'</span>&nbsp;&#43;&nbsp;reportId&nbsp;&#43;&nbsp;<span class="js__string">'&quot;,&quot;iss&quot;:&quot;PowerBISDK&quot;,&quot;aud&quot;:&quot;https://analysis.windows.net/powerbi/api&quot;,&quot;exp&quot;:'</span>&nbsp;&#43;&nbsp;exp&nbsp;&#43;&nbsp;<span class="js__string">',&quot;nbf&quot;:'</span>&nbsp;&#43;&nbsp;nbf&nbsp;&#43;&nbsp;<span class="js__string">'}'</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">var</span>&nbsp;endcodedToken&nbsp;=&nbsp;encode_helper(token1)&nbsp;&#43;&nbsp;<span class="js__string">'.'</span>&nbsp;&#43;&nbsp;encode_helper(token2);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">var</span>&nbsp;hash&nbsp;=&nbsp;CryptoJS.HmacSHA256(endcodedToken,&nbsp;accessKey);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">var</span>&nbsp;hashInBase64&nbsp;=&nbsp;CryptoJS.enc.Base64.stringify(hash);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">var</span>&nbsp;sig&nbsp;=&nbsp;formatString(hashInBase64);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">var</span>&nbsp;accessToken&nbsp;=&nbsp;endcodedToken&nbsp;&#43;&nbsp;<span class="js__string">'.'</span>&nbsp;&#43;&nbsp;sig;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">return</span>&nbsp;accessToken;&nbsp;
<span class="js__brace">}</span>&nbsp;
&nbsp;
<span class="js__operator">function</span>&nbsp;encode_helper(arg)&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">var</span>&nbsp;response&nbsp;=&nbsp;btoa(arg);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">return</span>&nbsp;formatString(response);&nbsp;
<span class="js__brace">}</span>&nbsp;
&nbsp;
<span class="js__sl_comment">//replace&nbsp;special&nbsp;char&nbsp;in&nbsp;the&nbsp;string</span>&nbsp;
<span class="js__operator">function</span>&nbsp;formatString(arg)&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">var</span>&nbsp;response&nbsp;=&nbsp;arg;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;response&nbsp;=&nbsp;response.replace(<span class="js__reg_exp">/\//g</span>,&nbsp;<span class="js__string">&quot;_&quot;</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;response&nbsp;=&nbsp;response.replace(<span class="js__reg_exp">/\&#43;/g</span>,&nbsp;<span class="js__string">&quot;-&quot;</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;response&nbsp;=&nbsp;response.replace(<span class="js__reg_exp">/=&#43;$/</span>,&nbsp;<span class="js__string">''</span>);;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">return</span>&nbsp;response;&nbsp;
<span class="js__brace">}</span></pre>
</div>
</div>
</div>
<div class="endscriptcode">&nbsp;Get workspaces</div>
<div class="endscriptcode">
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>JavaScript</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">js</span>
<pre class="hidden">function getWorkspaces(workspaceCollectionName, accessKey) {
    var requestUrl = &quot;https://api.powerbi.com/v1.0/collections/&quot; &#43; workspaceCollectionName &#43; &quot;/workspaces&quot;;
    var request = new Request(requestUrl, {
        headers: new Headers({
            'Authorization': 'AppKey ' &#43; accessKey
        })
    });
    fetch(request).then(function (response) {
        if (response.ok) {
            return response.json()
                .then(function (data) {
                    listWorkspaces(data.value, workspaceCollectionName, accessKey);
                });
        }
    });

}</pre>
<div class="preview">
<pre class="js"><span class="js__operator">function</span>&nbsp;getWorkspaces(workspaceCollectionName,&nbsp;accessKey)&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">var</span>&nbsp;requestUrl&nbsp;=&nbsp;<span class="js__string">&quot;https://api.powerbi.com/v1.0/collections/&quot;</span>&nbsp;&#43;&nbsp;workspaceCollectionName&nbsp;&#43;&nbsp;<span class="js__string">&quot;/workspaces&quot;</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">var</span>&nbsp;request&nbsp;=&nbsp;<span class="js__operator">new</span>&nbsp;Request(requestUrl,&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;headers:&nbsp;<span class="js__operator">new</span>&nbsp;Headers(<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">'Authorization'</span>:&nbsp;<span class="js__string">'AppKey&nbsp;'</span>&nbsp;&#43;&nbsp;accessKey&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">}</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">}</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;fetch(request).then(<span class="js__operator">function</span>&nbsp;(response)&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">if</span>&nbsp;(response.ok)&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">return</span>&nbsp;response.json()&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.then(<span class="js__operator">function</span>&nbsp;(data)&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;listWorkspaces(data.value,&nbsp;workspaceCollectionName,&nbsp;accessKey);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">}</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">}</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">}</span>);&nbsp;
&nbsp;
<span class="js__brace">}</span></pre>
</div>
</div>
</div>
</div>
<div class="endscriptcode">Get reports</div>
<div class="endscriptcode">
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>JavaScript</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">js</span>
<pre class="hidden">function getReports(workspaceId, workspaceCollectionName, accessKey) {
    var reportRequest = &quot;https://api.powerbi.com/v1.0/collections/&quot; &#43; workspaceCollectionName &#43; &quot;/workspaces/&quot; &#43; workspaceId &#43; &quot;/reports&quot;;
    var request1 = new Request(reportRequest, {
        headers: new Headers({
            'Authorization': 'AppKey ' &#43; accessKey
        })
    });
    fetch(request1).then(function (response) {
        if (response.ok) {
            return response.json().then(function (data) {
                listReports(data.value);
            });
        }
    });
}</pre>
<div class="preview">
<pre class="js"><span class="js__operator">function</span>&nbsp;getReports(workspaceId,&nbsp;workspaceCollectionName,&nbsp;accessKey)&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">var</span>&nbsp;reportRequest&nbsp;=&nbsp;<span class="js__string">&quot;https://api.powerbi.com/v1.0/collections/&quot;</span>&nbsp;&#43;&nbsp;workspaceCollectionName&nbsp;&#43;&nbsp;<span class="js__string">&quot;/workspaces/&quot;</span>&nbsp;&#43;&nbsp;workspaceId&nbsp;&#43;&nbsp;<span class="js__string">&quot;/reports&quot;</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">var</span>&nbsp;request1&nbsp;=&nbsp;<span class="js__operator">new</span>&nbsp;Request(reportRequest,&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;headers:&nbsp;<span class="js__operator">new</span>&nbsp;Headers(<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__string">'Authorization'</span>:&nbsp;<span class="js__string">'AppKey&nbsp;'</span>&nbsp;&#43;&nbsp;accessKey&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">}</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">}</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;fetch(request1).then(<span class="js__operator">function</span>&nbsp;(response)&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">if</span>&nbsp;(response.ok)&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">return</span>&nbsp;response.json().then(<span class="js__operator">function</span>&nbsp;(data)&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;listReports(data.value);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">}</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">}</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">}</span>);&nbsp;
<span class="js__brace">}</span></pre>
</div>
</div>
</div>
</div>
<div class="endscriptcode">Embed report</div>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>JavaScript</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">js</span>
<pre class="hidden">function embedReport(report, accessKey, workspaceCollectionName, workspaceId) {
    var embedUrl = report.embedUrl;
    var name = report.name;
    var reportId = report.id;
    var webUrl = report.webUrl;
    var token = getAccessToken(accessKey, workspaceId, reportId, workspaceCollectionName);
    var embedConfiguration = {
        type: 'report',
        accessToken: token,
        id: reportId,
        embedUrl: embedUrl
    };
    var $reportContainer = $('#reportContainer');
    var report = powerbi.embed($reportContainer.get(0), embedConfiguration);
}</pre>
<div class="preview">
<pre class="js"><span class="js__operator">function</span>&nbsp;embedReport(report,&nbsp;accessKey,&nbsp;workspaceCollectionName,&nbsp;workspaceId)&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">var</span>&nbsp;embedUrl&nbsp;=&nbsp;report.embedUrl;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">var</span>&nbsp;name&nbsp;=&nbsp;report.name;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">var</span>&nbsp;reportId&nbsp;=&nbsp;report.id;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">var</span>&nbsp;webUrl&nbsp;=&nbsp;report.webUrl;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">var</span>&nbsp;token&nbsp;=&nbsp;getAccessToken(accessKey,&nbsp;workspaceId,&nbsp;reportId,&nbsp;workspaceCollectionName);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">var</span>&nbsp;embedConfiguration&nbsp;=&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type:&nbsp;<span class="js__string">'report'</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accessToken:&nbsp;token,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;id:&nbsp;reportId,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;embedUrl:&nbsp;embedUrl&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">}</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">var</span>&nbsp;$reportContainer&nbsp;=&nbsp;$(<span class="js__string">'#reportContainer'</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">var</span>&nbsp;report&nbsp;=&nbsp;powerbi.embed($reportContainer.get(<span class="js__num">0</span>),&nbsp;embedConfiguration);&nbsp;
<span class="js__brace">}</span></pre>
</div>
</div>
</div>
<p style="margin-left:0pt; margin-right:0pt; margin-top:10pt; margin-bottom:.0001pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
<span style="font-weight:bold; font-size:12pt"><span style="font-weight:bold; font-size:12pt">More information</span></span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:.0001pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
<span><a href="https://code.msdn.microsoft.com/How-to-embed-a-Power-BI-1bb9c04a/https://docs.microsoft.com/en-us/azure/power-bi-embedded/power-bi-embedded-what-is-power-bi-embedded" style="text-decoration:none"><span style="color:#0563c1; text-decoration:underline">What is Microsoft Power BI Embedded</span></a></span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:.0001pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
<span><a href="https://code.msdn.microsoft.com/How-to-embed-a-Power-BI-1bb9c04a/https://code.msdn.microsoft.com/How-to-embed-a-Power-BI-1bb9c04a/https://docs.microsoft.com/en-us/azure/power-bi-embedded/power-bi-embedded-get-started-sample"><span style="color:#0563c1; text-decoration:underline">Get started with Microsoft Power BI Embedded</span></a></span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:.0001pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
<span><span style="color:#0563c1; text-decoration:underline"><a href="https://code.msdn.microsoft.com/How-to-embed-a-Power-BI-1bb9c04a/https://docs.microsoft.com/en-us/azure/power-bi-embedded/power-bi-embedded-iframe" style="text-decoration:none">How to use Power BI Embedded with REST</a></span></span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:.0001pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
<a href="https://code.msdn.microsoft.com/How-to-embed-a-Power-BI-1bb9c04a/https://www.azure.cn/documentation/articles/developerdifferences">Developer difference between Azure China and Global</a></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:.0001pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
<span><span style="color:#0563c1; text-decoration:underline"><br>
</span></span></p>
<p style="margin-left:0pt; margin-right:0pt; margin-top:0pt; margin-bottom:.0001pt; font-size:10.0pt; direction:ltr; unicode-bidi:normal">
<span><a name="_GoBack"></a></span></p>
<p style="line-height:0.6pt; color:white">Microsoft All-In-One Code Framework is a free, centralized code sample library driven by developers' real-world pains and needs. The goal is to provide customer-driven code samples for all Microsoft development technologies,
 and reduce developers' efforts in solving typical programming tasks. Our team listens to developers&rsquo; pains in the MSDN forums, social media and various DEV communities. We write code samples based on developers&rsquo; frequently asked programming tasks,
 and allow developers to download them with a short sample publishing cycle. Additionally, we offer a free code sample request service. It is a proactive way for our developer community to obtain code samples directly from Microsoft.</p>
<hr>
<div><a href="http://go.microsoft.com/?linkid=9759640" style="margin-top:3px"><img src="description/62e2e36b-4c58-47d8-8600-1bd7009bb5e0image.png" alt="">
</a></div>

</div>


    </div>
</body>
</html>
